{% extends 'main/base.html' %}
{% block content %}
<div class="container my-5">
  <h2 class="fw-bold text-primary mb-4">Manage Orders</h2>

  {% for order in orders %}
  <div class="card mb-3 shadow-sm">
    <div class="card-body">
      <div class="d-flex justify-content-between">
        <div>
          <h5 class="mb-1">Order #{{ order.id }} â€” <small class="text-muted">{{ order.ordered_at|date:"Y-m-d H:i" }}</small></h5>
          <p class="mb-1"><strong>Name:</strong> {{ order.full_name }} | <strong>Phone:</strong> {{ order.phone }}</p>
          <p class="mb-2"><strong>Address:</strong> {{ order.address }}</p>
        </div>
        <div>
          <form method="post" action="{% url 'update_order_status' order.id %}" class="d-flex align-items-center gap-2">
            {% csrf_token %}
            <select name="status" class="form-select form-select-sm">
              {% for value, label in order.STATUS_CHOICES %}
                <option value="{{ value }}" {% if order.status == value %}selected{% endif %}>{{ label }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn btn-sm btn-outline-success">Update</button>
          </form>

          <form method="post" action="{% url 'delete_order' order.id %}" class="mt-2">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger"
              onclick="return confirm('Are you sure you want to delete this order?');">
              Delete
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
    <p class="text-center">No orders found.</p>
  {% endfor %}
</div>
{% endblock %}